{"ast":null,"code":"import _asyncToGenerator from \"/home/joao/Projects/payment-live-chat/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { inject } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { KeycloakService } from 'keycloak-angular';\nimport { AuthService } from '../services/auth.service';\nexport const AuthGuard = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(function* (route, state) {\n    const keycloak = inject(KeycloakService);\n    const router = inject(Router);\n    const authService = inject(AuthService);\n    const isLoggedIn = yield keycloak.isLoggedIn();\n    if (!isLoggedIn) {\n      yield keycloak.login({\n        redirectUri: window.location.origin + state.url\n      });\n      return false;\n    }\n    // Sync user to backend database after Keycloak authentication\n    yield authService.syncUserToBackend();\n    return true;\n  });\n  return function AuthGuard(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();","map":{"version":3,"names":["inject","Router","KeycloakService","AuthService","AuthGuard","_ref","_asyncToGenerator","route","state","keycloak","router","authService","isLoggedIn","login","redirectUri","window","location","origin","url","syncUserToBackend","_x","_x2","apply","arguments"],"sources":["/home/joao/Projects/payment-live-chat/frontend/src/app/guards/auth.guard.ts"],"sourcesContent":["import { inject } from '@angular/core';\nimport { Router, CanActivateFn } from '@angular/router';\nimport { KeycloakService } from 'keycloak-angular';\nimport { AuthService } from '../services/auth.service';\n\nexport const AuthGuard: CanActivateFn = async (route, state) => {\n  const keycloak = inject(KeycloakService);\n  const router = inject(Router);\n  const authService = inject(AuthService);\n\n  const isLoggedIn = await keycloak.isLoggedIn();\n\n  if (!isLoggedIn) {\n    await keycloak.login({\n      redirectUri: window.location.origin + state.url\n    });\n    return false;\n  }\n\n  // Sync user to backend database after Keycloak authentication\n  await authService.syncUserToBackend();\n\n  return true;\n};\n"],"mappings":";AAAA,SAASA,MAAM,QAAQ,eAAe;AACtC,SAASC,MAAM,QAAuB,iBAAiB;AACvD,SAASC,eAAe,QAAQ,kBAAkB;AAClD,SAASC,WAAW,QAAQ,0BAA0B;AAEtD,OAAO,MAAMC,SAAS;EAAA,IAAAC,IAAA,GAAAC,iBAAA,CAAkB,WAAOC,KAAK,EAAEC,KAAK,EAAI;IAC7D,MAAMC,QAAQ,GAAGT,MAAM,CAACE,eAAe,CAAC;IACxC,MAAMQ,MAAM,GAAGV,MAAM,CAACC,MAAM,CAAC;IAC7B,MAAMU,WAAW,GAAGX,MAAM,CAACG,WAAW,CAAC;IAEvC,MAAMS,UAAU,SAASH,QAAQ,CAACG,UAAU,EAAE;IAE9C,IAAI,CAACA,UAAU,EAAE;MACf,MAAMH,QAAQ,CAACI,KAAK,CAAC;QACnBC,WAAW,EAAEC,MAAM,CAACC,QAAQ,CAACC,MAAM,GAAGT,KAAK,CAACU;OAC7C,CAAC;MACF,OAAO,KAAK;;IAGd;IACA,MAAMP,WAAW,CAACQ,iBAAiB,EAAE;IAErC,OAAO,IAAI;EACb,CAAC;EAAA,gBAlBYf,SAASA,CAAAgB,EAAA,EAAAC,GAAA;IAAA,OAAAhB,IAAA,CAAAiB,KAAA,OAAAC,SAAA;EAAA;AAAA,GAkBrB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}